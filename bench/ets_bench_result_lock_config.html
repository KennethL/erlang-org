<!doctype html>
<html lang="en">

<!-- %% -->
<!-- %% %CopyrightBegin% -->
<!-- %% -->
<!-- %% Copyright Ericsson AB and Kjell Winblad 1996-2020. All Rights Reserved. -->
<!-- %% -->
<!-- %% Licensed under the Apache License, Version 2.0 (the "License"); -->
<!-- %% you may not use this file except in compliance with the License. -->
<!-- %% You may obtain a copy of the License at -->
<!-- %% -->
<!-- %%     http://www.apache.org/licenses/LICENSE-2.0 -->
<!-- %% -->
<!-- %% Unless required by applicable law or agreed to in writing, software -->
<!-- %% distributed under the License is distributed on an "AS IS" BASIS, -->
<!-- %% WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. -->
<!-- %% See the License for the specific language governing permissions and -->
<!-- %% limitations under the License. -->
<!-- %% -->
<!-- %% %CopyrightEnd% -->
<!-- %% -->
<!-- %% Author: Kjell Winblad -->
<!-- %% -->
  
  <head>
    <meta charset="utf-8">
    <title>ETS Benchmark Result Viewer</title>
  </head>
<body>

  <h1>About</h1>
  <p>
    This page contains benchmark results for the new ETS options
    {write_concurrency, auto} and {write_concurrency, N} (where N is
    an
    integer). See <a href="https://github.com/kjellwinblad/otp/commit/1b578e20634b2f5327c85879d009a60152583f52">commit
    1b578e20634b2f5327c85879d009a60152583f52</a> and the two prior
    commits for more information about the new options.
  </p>
  
    <h2>Benchmark Description</h2>
<p>
    The benchmark measures how many ETS operations per second X Erlang processes can perform on a single table.
    Each of the X processes repeatedly selects an operation to do from a given set of operations.
    The likelihood that a certain operation will be selected is also given to the benchmark.
    The table that the processes operate on is prefilled with 500K items before each benchmark run starts.
</p>
<p>
    The source code for the benchmark is located in the function <code>ets_SUITE:throughput_benchmark/0</code> (see "<code>$ERL_TOP/lib/stdlib/test/ets_SUITE.erl</code>").
    Below is a list with brief descriptions of the operations:
</p>
    <ul>
      <li>insert = an <code>ets:insert/2</code> call with a random item within the key range as the second parameter value</li>
      <li>remove = an <code>ets:remove/2</code> call with a random item within the key range as the second parameter value</li>
      <li>lookup = an <code>ets:lookup/2</code> call with a random item within the key range as the second parameter value</li>
    </ul>

  <h2>Machine Configuration</h2>
  <p>
    <b>Machine:</b><br />
    Microsoft Azure VM instance: Standard D64s v3 (64 vcpus, 256 GB memory): <br />
    <ul>
      <li>2 * Intel(R) Xeon(R) CPU E5-2673 v4 @ 2.30GHz (16 cores with hyper-threading)</li>
      <li>2 NUMA nodes</li>
      <li>32 cores</li>
      <li>64 hardware threads</li>
      <li>256GB ram</li>
    </ul>
  </p>
  <p>
    <b>Operating System:</b>
    <pre>
      Description:	Ubuntu 18.04.2 LTS
      Linux version:	5.4.0-1051-azure
    </pre>
  </p>

  <h2>Run-time Parameters</h2>

  <p>
    The benchmark was started with the parameter <a href="https://erlang.org/doc/man/erl.html">"+sbt tnnps"</a>.
  </p>

  <pre>
    erl +sbt tnnps -eval "parallel_messages_SUITE:throughput_benchmark(),erlang:halt()"
  </pre>

  <h2>Benchmark Configuration</h2>

  <p>
    The benchmark configuration used can be found <a href="https://github.com/kjellwinblad/otp/blob/641ff38ca1f290673d6a74a8a9e07903ae50fca0/ets_SUITE.erl#L7584">here</a>.
  </p>

  <h2>Results</h2>
  <ul>
    <li>Results for the {write_concurrency, auto} and {write_concurrency, N} (where N is an integer) options are based on commit (<a href="https://github.com/kjellwinblad/otp/tree/7cee4c135bc2f5eb1a91b85f856e2563d63d9dec">7cee4c135bc2f5eb1a91b85f856e2563d63d9dec</a>)</li>
    <li>Results from the master branch  are based on commit (<a href="https://github.com/erlang/otp/tree/85530f5fb3b1f737a43206c7d14c5790ca694fb5">85530f5fb3b1f737a43206c7d14c5790ca694fb5</a>)</li>
    <li>Click on the "Fill screen" buttons to make the graphs larger</li>
    <li>One can hide/show lines by clicking on their labels in the legend of the graphs</li>
  </ul>

    <div id="insertPlaceholder"></div>
    <h1>ETS Benchmark Result Viewer</h1>
    <p>
      This page generates graphs from data produced by the ETS benchmark which is defined in the function <code>ets_SUITE:throughput_benchmark/0</code> (see "<code>$ERL_TOP/lib/stdlib/test/ets_SUITE.erl</code>").
    </p>
    <p>
      Note that one can paste results from several benchmark runs into the field below. Results from the same scenario but from different benchmark runs will be relabeled and plotted in the same graph automatically. This makes comparisons of different ETS versions easy. 
    </p>
    <p>
      Note also that that lines can be hidden by clicking on the corresponding label.
    </p>
    Paste the generated data in the field below and press the Render button:
    <br>
    <textarea id="dataField" rows="4" cols="50"># Each instance of the benchmark runs for 15.0 seconds:
# The result of a benchmark instance is presented as a number representing
# the number of operations performed per second:


# To plot graphs for the results below:
# 1. Open "$ERL_TOP/lib/stdlib/test/ets_SUITE_data/visualize_throughput.html" in a web browser
# 2. Copy the lines between "#BENCHMARK STARTED$" and "#BENCHMARK ENDED$" below
# 3. Paste the lines copied in step 2 to the text box in the browser window opened in
#    step 1 and press the Render button

#BENCHMARK STARTED$
Scenario:  50.000000% insert,  50.000000% delete | Key Range Size: 1000000$
; 1; 2; 4; 8; 16; 32; 64$
,[set,public,{write_concurrency,auto}] ; 1638296.266667; 2772256.000000; 4793465.333333; 8850922.933333; 18189495.666667; 26835741.800000; 33254172.800000$
,[set,public,{write_concurrency,auto},{read_concurrency,true}] ; 1684673.533333; 2706115.600000; 5052121.400000; 9295621.600000; 19049700.866667; 29038185.866667; 36258969.133333$
Scenario:  10.000000% insert,  10.000000% delete,  80.000000% lookup | Key Range Size: 1000000$
; 1; 2; 4; 8; 16; 32; 64$
,[set,public,{write_concurrency,auto}] ; 1823638.333333; 3032324.800000; 5554639.666667; 11275874.400000; 22065863.600000; 36420372.333333; 46790152.066667$
,[set,public,{write_concurrency,auto},{read_concurrency,true}] ; 1554512.266667; 2597407.800000; 5481266.400000; 11202602.400000; 22444644.200000; 36073013.400000; 47477784.266667$
Scenario:  1.000000% insert,  1.000000% delete,  98.000000% lookup | Key Range Size: 1000000$
; 1; 2; 4; 8; 16; 32; 64$
,[set,public,{write_concurrency,auto}] ; 1836692.066667; 3166819.600000; 6118789.866667; 12011037.200000; 23625766.800000; 41922330.200000; 51452277.733333$
,[set,public,{write_concurrency,auto},{read_concurrency,true}] ; 1417571.800000; 2504979.400000; 5083578.200000; 11438133.800000; 23251884.800000; 41523855.800000; 51122828.133333$
Scenario:  100.000000% lookup | Key Range Size: 1000000$
; 1; 2; 4; 8; 16; 32; 64$
,[set,public,{write_concurrency,auto}] ; 1701037.466667; 2987203.733333; 5722271.066667; 12065403.466667; 24323309.066667; 40865476.533333; 52304944.400000$
,[set,public,{write_concurrency,auto},{read_concurrency,true}] ; 1614473.200000; 2728092.333333; 5710741.866667; 11314414.800000; 23627314.866667; 44512531.600000; 56349139.800000$

#BENCHMARK ENDED$



#BENCHMARK STARTED$
Scenario:  50.000000% insert,  50.000000% delete | Key Range Size: 1000000$
; 1; 2; 4; 8; 16; 32; 64$
,[set,public,{write_concurrency,true},{decentralized_counters,true}] ; 1854958.733333; 3129221.133333; 5574487.533333; 10033393.066667; 1117360.133333; 1066077.933333; 1137498.066667$
,[set,public,{write_concurrency,true},{read_concurrency,true},{decentralized_counters,true}] ; 1902625.066667; 3295980.666667; 5668245.200000; 9909413.800000; 1102767.266667; 1061872.400000; 1148004.200000$
,[set,public,{write_concurrency,1},{decentralized_counters,true}] ; 1816290.400000; 2525198.666667; 1113057.600000; 82349.533333; 19326.000000; 17637.133333; 19320.466667$
,[set,public,{write_concurrency,32},{decentralized_counters,true}] ; 1764486.733333; 3416912.200000; 5605198.533333; 9776514.200000; 564857.600000; 513956.533333; 616125.933333$
,[set,public,{write_concurrency,64},{decentralized_counters,true}] ; 1858648.733333; 3239323.333333; 5514314.600000; 9356870.666667; 1113930.866667; 1060672.800000; 1163894.733333$
,[set,public,{write_concurrency,128},{decentralized_counters,true}] ; 1926803.600000; 3171311.866667; 5731420.866667; 10193782.800000; 9302524.400000; 2128905.800000; 2273146.000000$
,[set,public,{write_concurrency,256},{decentralized_counters,true}] ; 1341869.933333; 3192184.666667; 5746163.466667; 10260251.800000; 17643739.200000; 4251577.000000; 4562250.266667$
,[set,public,{write_concurrency,512},{decentralized_counters,true}] ; 1795140.266667; 3590890.333333; 5989294.800000; 9863755.733333; 19202027.666667; 28122080.733333; 9480096.933333$
,[set,public,{write_concurrency,1024},{decentralized_counters,true}] ; 1762024.133333; 3462011.266667; 5983604.466667; 10179699.133333; 18431535.800000; 28568245.866667; 31223248.333333$
,[set,public,{write_concurrency,2048},{decentralized_counters,true}] ; 1858605.866667; 3538741.200000; 6016065.400000; 10300093.066667; 19578161.800000; 31028371.066667; 37118613.533333$
,[set,public,{write_concurrency,4096},{decentralized_counters,true}] ; 1837198.533333; 3482948.533333; 6062622.266667; 10369864.266667; 19702979.933333; 31420185.600000; 35738432.866667$
,[set,public,{write_concurrency,8192},{decentralized_counters,true}] ; 1850688.400000; 3509571.200000; 6195623.200000; 10834324.600000; 19797253.000000; 31694885.466667; 37663898.066667$
,[set,public,{write_concurrency,16384},{decentralized_counters,true}] ; 1907255.866667; 3483501.266667; 5889950.266667; 10686478.266667; 19136468.866667; 31761834.266667; 38293288.733333$
,[set,public,{write_concurrency,32768},{decentralized_counters,true}] ; 1877302.333333; 3452779.533333; 6264619.866667; 10817257.466667; 20129913.400000; 32652361.866667; 36929609.066667$
,[set,public,{write_concurrency,1},{read_concurrency,true},{decentralized_counters,true}] ; 2014383.600000; 2410116.200000; 1167491.400000; 86200.066667; 19472.133333; 17363.866667; 19823.866667$
,[set,public,{write_concurrency,32},{read_concurrency,true},{decentralized_counters,true}] ; 1977334.000000; 3323531.733333; 5699764.933333; 7608898.266667; 563446.466667; 527558.133333; 592912.800000$
,[set,public,{write_concurrency,64},{read_concurrency,true},{decentralized_counters,true}] ; 1831382.933333; 3390458.600000; 5728031.200000; 9275951.066667; 1123581.933333; 1059597.333333; 1166198.533333$
,[set,public,{write_concurrency,128},{read_concurrency,true},{decentralized_counters,true}] ; 2021196.733333; 3363886.600000; 5950534.266667; 9960448.466667; 10052005.133333; 2102210.466667; 2261435.466667$
,[set,public,{write_concurrency,256},{read_concurrency,true},{decentralized_counters,true}] ; 1789642.000000; 3534373.333333; 5803243.533333; 9612831.133333; 17701246.933333; 4280989.400000; 4580488.333333$
,[set,public,{write_concurrency,512},{read_concurrency,true},{decentralized_counters,true}] ; 1915031.666667; 3478904.933333; 5973225.000000; 10161435.400000; 19161756.133333; 8494105.400000; 9352978.600000$
,[set,public,{write_concurrency,1024},{read_concurrency,true},{decentralized_counters,true}] ; 1743805.066667; 3608467.066667; 6059434.466667; 10564993.333333; 19583245.600000; 30649458.066667; 34658375.866667$
,[set,public,{write_concurrency,2048},{read_concurrency,true},{decentralized_counters,true}] ; 1809559.266667; 3507180.266667; 5871495.266667; 10452995.266667; 18698193.266667; 31044340.466667; 34110931.933333$
,[set,public,{write_concurrency,4096},{read_concurrency,true},{decentralized_counters,true}] ; 1939196.066667; 3545005.733333; 5959962.000000; 10912568.400000; 19533110.733333; 31482311.533333; 35706282.600000$
,[set,public,{write_concurrency,8192},{read_concurrency,true},{decentralized_counters,true}] ; 1880577.800000; 3604309.466667; 5947436.133333; 10556282.266667; 19839552.400000; 31773930.866667; 37398722.666667$
,[set,public,{write_concurrency,16384},{read_concurrency,true},{decentralized_counters,true}] ; 1862688.200000; 3517429.400000; 6230488.466667; 10406768.066667; 19901262.333333; 30692325.800000; 37632126.800000$
,[set,public,{write_concurrency,32768},{read_concurrency,true},{decentralized_counters,true}] ; 1993971.066667; 3234193.266667; 6008652.066667; 10917301.400000; 20272570.466667; 32993928.733333; 38114434.400000$
Scenario:  10.000000% insert,  10.000000% delete,  80.000000% lookup | Key Range Size: 1000000$
; 1; 2; 4; 8; 16; 32; 64$
,[set,public,{write_concurrency,true},{decentralized_counters,true}] ; 2103099.800000; 3500089.333333; 6387721.600000; 11895041.800000; 21861716.200000; 4424051.733333; 4932080.666667$
,[set,public,{write_concurrency,true},{read_concurrency,true},{decentralized_counters,true}] ; 1795650.066667; 3224114.333333; 5618687.200000; 9675626.133333; 16750829.666667; 6485037.066667; 4877816.133333$
,[set,public,{write_concurrency,1},{decentralized_counters,true}] ; 1909162.266667; 3330526.933333; 2330294.866667; 1055300.133333; 145233.600000; 57739.400000; 76578.200000$
,[set,public,{write_concurrency,32},{decentralized_counters,true}] ; 2063773.933333; 3466790.733333; 6425926.200000; 11574741.866667; 20088389.666667; 1938467.866667; 2449203.333333$
,[set,public,{write_concurrency,64},{decentralized_counters,true}] ; 1961138.666667; 3905711.933333; 6994830.000000; 12078686.600000; 21010454.533333; 4494550.866667; 4963942.333333$
,[set,public,{write_concurrency,128},{decentralized_counters,true}] ; 1870286.933333; 3853521.133333; 6846947.666667; 12146294.666667; 22150012.000000; 29724651.133333; 10087841.866667$
,[set,public,{write_concurrency,256},{decentralized_counters,true}] ; 1908156.133333; 3535138.266667; 7126308.266667; 12262683.800000; 22565507.333333; 36665504.400000; 27551794.533333$
,[set,public,{write_concurrency,512},{decentralized_counters,true}] ; 2055087.400000; 3894797.866667; 6938648.866667; 12177448.066667; 22709490.133333; 38265473.000000; 45696817.066667$
,[set,public,{write_concurrency,1024},{decentralized_counters,true}] ; 2176879.866667; 3386731.066667; 6507545.866667; 12297844.333333; 22624803.000000; 39025774.066667; 47489848.000000$
,[set,public,{write_concurrency,2048},{decentralized_counters,true}] ; 2063378.533333; 3465658.533333; 6508217.666667; 12405794.733333; 22945629.200000; 39985408.533333; 47866766.200000$
,[set,public,{write_concurrency,4096},{decentralized_counters,true}] ; 2054023.200000; 3413068.666667; 6464107.400000; 12327904.000000; 21818250.733333; 40063195.466667; 48959539.933333$
,[set,public,{write_concurrency,8192},{decentralized_counters,true}] ; 2076503.866667; 3429192.266667; 6995824.200000; 12097700.466667; 23088792.333333; 40255592.066667; 48501634.466667$
,[set,public,{write_concurrency,16384},{decentralized_counters,true}] ; 2046444.066667; 3931158.800000; 6484209.733333; 11984892.266667; 22950364.533333; 39051901.066667; 50077983.533333$
,[set,public,{write_concurrency,32768},{decentralized_counters,true}] ; 1831497.933333; 3446401.800000; 6932425.733333; 11820773.533333; 23175901.266667; 40397367.866667; 49746472.666667$
,[set,public,{write_concurrency,1},{read_concurrency,true},{decentralized_counters,true}] ; 1894121.800000; 2481908.533333; 1109085.933333; 855328.200000; 146709.200000; 58427.466667; 77724.400000$
,[set,public,{write_concurrency,32},{read_concurrency,true},{decentralized_counters,true}] ; 1783341.933333; 2999346.466667; 5600808.733333; 9237948.800000; 13703262.400000; 1902031.133333; 2469621.866667$
,[set,public,{write_concurrency,64},{read_concurrency,true},{decentralized_counters,true}] ; 1555451.800000; 3269987.800000; 5674329.533333; 9885410.466667; 16697547.733333; 7137061.733333; 4964121.066667$
,[set,public,{write_concurrency,128},{read_concurrency,true},{decentralized_counters,true}] ; 1840543.600000; 2956000.066667; 5422183.800000; 10111817.000000; 17915967.133333; 22162535.666667; 9926236.000000$
,[set,public,{write_concurrency,256},{read_concurrency,true},{decentralized_counters,true}] ; 1696409.800000; 2963908.066667; 5449437.600000; 9866387.866667; 18348177.666667; 26695531.933333; 30469914.133333$
,[set,public,{write_concurrency,512},{read_concurrency,true},{decentralized_counters,true}] ; 1476515.733333; 3099789.666667; 5365237.200000; 10199934.200000; 18314620.400000; 28054197.266667; 37465976.466667$
,[set,public,{write_concurrency,1024},{read_concurrency,true},{decentralized_counters,true}] ; 1641511.933333; 3203439.133333; 5565168.000000; 9808194.066667; 18756917.733333; 29285167.200000; 38076974.266667$
,[set,public,{write_concurrency,2048},{read_concurrency,true},{decentralized_counters,true}] ; 1606624.466667; 2802651.133333; 5129691.000000; 9603184.666667; 17894581.933333; 29052012.133333; 38677451.066667$
,[set,public,{write_concurrency,4096},{read_concurrency,true},{decentralized_counters,true}] ; 1393385.333333; 2582144.933333; 5090064.000000; 9370253.466667; 18022728.000000; 29759820.800000; 38782285.666667$
,[set,public,{write_concurrency,8192},{read_concurrency,true},{decentralized_counters,true}] ; 1482847.466667; 2824957.933333; 4893967.000000; 8999072.600000; 16748373.933333; 27097347.933333; 38339057.533333$
,[set,public,{write_concurrency,16384},{read_concurrency,true},{decentralized_counters,true}] ; 1361422.200000; 2645011.466667; 4819578.933333; 8580337.200000; 15962483.533333; 26072543.266667; 36784523.600000$
,[set,public,{write_concurrency,32768},{read_concurrency,true},{decentralized_counters,true}] ; 1232842.000000; 2435970.866667; 4401217.466667; 8089028.000000; 15267972.866667; 25336163.466667; 34960414.066667$
Scenario:  1.000000% insert,  1.000000% delete,  98.000000% lookup | Key Range Size: 1000000$
; 1; 2; 4; 8; 16; 32; 64$
,[set,public,{write_concurrency,true},{decentralized_counters,true}] ; 2006937.800000; 4215071.266667; 6788688.400000; 12653189.666667; 23939736.466667; 40765298.066667; 35624006.133333$
,[set,public,{write_concurrency,true},{read_concurrency,true},{decentralized_counters,true}] ; 1987200.200000; 3326971.333333; 6086587.133333; 11526964.600000; 21877515.800000; 30854837.266667; 21793951.800000$
,[set,public,{write_concurrency,1},{decentralized_counters,true}] ; 2197928.866667; 3826890.266667; 4839165.200000; 4284733.333333; 2900132.266667; 336686.533333; 209488.333333$
,[set,public,{write_concurrency,32},{decentralized_counters,true}] ; 2180072.266667; 3580582.200000; 7276696.266667; 13016320.200000; 22857036.533333; 31323938.933333; 6686005.666667$
,[set,public,{write_concurrency,64},{decentralized_counters,true}] ; 1834762.933333; 4259852.733333; 7439148.666667; 13097127.000000; 24554071.000000; 39535981.800000; 32694786.800000$
,[set,public,{write_concurrency,128},{decentralized_counters,true}] ; 2129289.600000; 4127339.666667; 7047580.733333; 13099144.600000; 23467292.466667; 42875245.200000; 45883174.400000$
,[set,public,{write_concurrency,256},{decentralized_counters,true}] ; 2267150.666667; 4154845.000000; 7063779.933333; 12887413.266667; 24619147.533333; 41449506.733333; 47720397.466667$
,[set,public,{write_concurrency,512},{decentralized_counters,true}] ; 2175464.933333; 3613589.066667; 7220560.533333; 12736279.266667; 24888361.000000; 44110812.666667; 52484095.733333$
,[set,public,{write_concurrency,1024},{decentralized_counters,true}] ; 2078255.000000; 3618380.333333; 6789464.066667; 12730499.466667; 24794877.266667; 44921026.866667; 53282336.400000$
,[set,public,{write_concurrency,2048},{decentralized_counters,true}] ; 2084868.400000; 3555560.466667; 6767626.600000; 12704096.666667; 23243615.666667; 41752245.200000; 52745424.200000$
,[set,public,{write_concurrency,4096},{decentralized_counters,true}] ; 2132070.866667; 3663860.066667; 7168981.266667; 12747401.800000; 23771479.000000; 42554408.066667; 49509170.866667$
,[set,public,{write_concurrency,8192},{decentralized_counters,true}] ; 1981341.800000; 3635112.533333; 7523361.933333; 12366603.800000; 25083587.866667; 43359568.933333; 53962767.666667$
,[set,public,{write_concurrency,16384},{decentralized_counters,true}] ; 2145397.600000; 4073228.200000; 7306917.066667; 13014546.600000; 23643278.933333; 42776390.000000; 54359385.933333$
,[set,public,{write_concurrency,32768},{decentralized_counters,true}] ; 2098099.733333; 4088658.800000; 7180085.666667; 12612799.866667; 24664753.266667; 44721138.466667; 53782106.800000$
,[set,public,{write_concurrency,1},{read_concurrency,true},{decentralized_counters,true}] ; 1869835.533333; 3622625.800000; 3820575.933333; 3149145.466667; 2396793.266667; 329501.400000; 207382.800000$
,[set,public,{write_concurrency,32},{read_concurrency,true},{decentralized_counters,true}] ; 1944452.666667; 3310598.066667; 6086229.333333; 11342934.866667; 20814011.800000; 19110818.200000; 6612489.066667$
,[set,public,{write_concurrency,64},{read_concurrency,true},{decentralized_counters,true}] ; 1807929.333333; 3865974.400000; 6713334.200000; 11420076.800000; 22168947.600000; 30976294.266667; 20941468.133333$
,[set,public,{write_concurrency,128},{read_concurrency,true},{decentralized_counters,true}] ; 1999442.800000; 3693707.066667; 6662445.400000; 11628135.333333; 21960388.866667; 35651529.133333; 42606323.733333$
,[set,public,{write_concurrency,256},{read_concurrency,true},{decentralized_counters,true}] ; 1898530.533333; 3236732.466667; 6435101.000000; 11264235.466667; 21849559.933333; 37277679.933333; 46730687.333333$
,[set,public,{write_concurrency,512},{read_concurrency,true},{decentralized_counters,true}] ; 1757301.066667; 3579625.066667; 6118482.533333; 11281824.000000; 21900335.333333; 37731512.800000; 48403703.133333$
,[set,public,{write_concurrency,1024},{read_concurrency,true},{decentralized_counters,true}] ; 1716147.066667; 3551988.600000; 6478741.066667; 11303936.200000; 21307052.866667; 36425945.600000; 46814597.800000$
,[set,public,{write_concurrency,2048},{read_concurrency,true},{decentralized_counters,true}] ; 1642027.533333; 3528214.333333; 6168650.200000; 10848864.333333; 21595883.466667; 37663214.600000; 48877320.600000$
,[set,public,{write_concurrency,4096},{read_concurrency,true},{decentralized_counters,true}] ; 1587882.466667; 3064724.000000; 5772348.200000; 11445315.066667; 20813277.133333; 36466500.266667; 47912352.066667$
,[set,public,{write_concurrency,8192},{read_concurrency,true},{decentralized_counters,true}] ; 1708324.200000; 3309172.866667; 6047101.000000; 11147124.600000; 20390267.000000; 35738245.400000; 48146617.133333$
,[set,public,{write_concurrency,16384},{read_concurrency,true},{decentralized_counters,true}] ; 1716948.600000; 3333728.866667; 5750514.866667; 10626592.866667; 19361272.933333; 35029716.733333; 46910371.533333$
,[set,public,{write_concurrency,32768},{read_concurrency,true},{decentralized_counters,true}] ; 1625841.933333; 3279120.266667; 5532833.266667; 10280644.933333; 19344857.266667; 33726328.666667; 45898814.066667$
Scenario:  100.000000% lookup | Key Range Size: 1000000$
; 1; 2; 4; 8; 16; 32; 64$
,[set,public,{write_concurrency,true},{decentralized_counters,true}] ; 2212641.266667; 4369934.800000; 7554232.600000; 13936721.466667; 25016025.600000; 45191639.866667; 54073544.200000$
,[set,public,{write_concurrency,true},{read_concurrency,true},{decentralized_counters,true}] ; 2023080.466667; 3947733.933333; 7431879.000000; 12383149.133333; 24158864.000000; 45230395.400000; 54799859.266667$
,[set,public,{write_concurrency,1},{decentralized_counters,true}] ; 2209904.333333; 4166817.333333; 6759698.133333; 6465853.866667; 10322858.866667; 6184505.133333; 5579157.533333$
,[set,public,{write_concurrency,32},{decentralized_counters,true}] ; 2106300.400000; 4339664.466667; 7706432.133333; 12954613.800000; 25452915.466667; 43508597.466667; 48828490.666667$
,[set,public,{write_concurrency,64},{decentralized_counters,true}] ; 2165744.000000; 4349287.800000; 7836644.266667; 13197308.666667; 25423487.000000; 44569895.400000; 54100975.133333$
,[set,public,{write_concurrency,128},{decentralized_counters,true}] ; 2232345.400000; 4263148.666667; 7288564.333333; 13756785.200000; 24416596.400000; 45949763.400000; 55136032.466667$
,[set,public,{write_concurrency,256},{decentralized_counters,true}] ; 2174544.200000; 4284993.133333; 7745668.666667; 13094874.466667; 24949007.866667; 45426911.200000; 55932223.733333$
,[set,public,{write_concurrency,512},{decentralized_counters,true}] ; 2222423.200000; 4308281.133333; 7768012.200000; 14085699.533333; 25858050.866667; 46685628.533333; 56490414.733333$
,[set,public,{write_concurrency,1024},{decentralized_counters,true}] ; 2201400.933333; 4377839.000000; 7670119.533333; 13393860.333333; 24759302.733333; 46695724.933333; 56600402.200000$
,[set,public,{write_concurrency,2048},{decentralized_counters,true}] ; 2232259.866667; 4400281.400000; 7511764.933333; 13712973.200000; 24642297.800000; 45796860.600000; 52509085.533333$
,[set,public,{write_concurrency,4096},{decentralized_counters,true}] ; 2149907.000000; 4339841.933333; 7458366.733333; 14012212.000000; 25962671.200000; 47874069.666667; 55961629.266667$
,[set,public,{write_concurrency,8192},{decentralized_counters,true}] ; 2217935.066667; 4291484.733333; 7754661.333333; 13109752.600000; 25679586.266667; 46816066.533333; 57016902.066667$
,[set,public,{write_concurrency,16384},{decentralized_counters,true}] ; 2160753.866667; 4265445.400000; 7767244.800000; 13075826.866667; 25831525.466667; 44967737.200000; 57112592.866667$
,[set,public,{write_concurrency,32768},{decentralized_counters,true}] ; 2125805.200000; 4390829.266667; 7482735.866667; 13993314.333333; 24605786.866667; 46159144.800000; 56684507.533333$
,[set,public,{write_concurrency,1},{read_concurrency,true},{decentralized_counters,true}] ; 2024865.666667; 4029131.200000; 7258817.266667; 12410943.133333; 24019777.866667; 44432351.133333; 53711493.466667$
,[set,public,{write_concurrency,32},{read_concurrency,true},{decentralized_counters,true}] ; 1993078.666667; 4024347.200000; 7298979.200000; 12687654.066667; 23839121.000000; 45541795.133333; 55046285.933333$
,[set,public,{write_concurrency,64},{read_concurrency,true},{decentralized_counters,true}] ; 2132246.800000; 3563691.000000; 6629295.866667; 12718785.533333; 23866457.333333; 45810631.200000; 55120705.200000$
,[set,public,{write_concurrency,128},{read_concurrency,true},{decentralized_counters,true}] ; 2013863.733333; 3455239.600000; 6576701.533333; 12701875.000000; 24071113.466667; 46192029.533333; 55103370.933333$
,[set,public,{write_concurrency,256},{read_concurrency,true},{decentralized_counters,true}] ; 2023809.266667; 3411306.466667; 6536714.733333; 12775539.333333; 23500978.600000; 47480891.000000; 55247754.000000$
,[set,public,{write_concurrency,512},{read_concurrency,true},{decentralized_counters,true}] ; 1944206.400000; 3370363.266667; 6414601.666667; 12557703.866667; 23461958.400000; 44135178.666667; 55171508.533333$
,[set,public,{write_concurrency,1024},{read_concurrency,true},{decentralized_counters,true}] ; 1903467.933333; 3296479.466667; 6306778.200000; 11728979.866667; 22783959.466667; 43197967.133333; 53772189.266667$
,[set,public,{write_concurrency,2048},{read_concurrency,true},{decentralized_counters,true}] ; 1870587.733333; 3249288.133333; 6208930.733333; 11952589.266667; 22638211.800000; 43169242.400000; 53126090.600000$
,[set,public,{write_concurrency,4096},{read_concurrency,true},{decentralized_counters,true}] ; 1834102.333333; 3263728.933333; 6214694.466667; 11987125.200000; 22867478.400000; 43706844.400000; 54399258.800000$
,[set,public,{write_concurrency,8192},{read_concurrency,true},{decentralized_counters,true}] ; 1822844.400000; 3256655.066667; 6293998.333333; 11842832.066667; 21638727.466667; 42241998.133333; 53018647.533333$
,[set,public,{write_concurrency,16384},{read_concurrency,true},{decentralized_counters,true}] ; 1756423.800000; 3183247.533333; 6191033.133333; 11246673.200000; 21289475.266667; 40641872.400000; 51889101.133333$
,[set,public,{write_concurrency,32768},{read_concurrency,true},{decentralized_counters,true}] ; 1818359.333333; 3305603.466667; 6093389.800000; 11232455.533333; 20674408.400000; 40043743.400000; 50903943.400000$

#BENCHMARK ENDED$








#BENCHMARK STARTED$
Scenario:  50.000000% insert,  50.000000% delete | Key Range Size: 1000000$
; 1; 2; 4; 8; 16; 32; 64$
,(master)[set,public,{write_concurrency,true},{decentralized_counters,true}] ; 1387034.333333; 2528887.466667; 4953011.933333; 9107190.000000; 16173751.600000; 828504.200000; 1093059.000000$
,(master)[set,public,{write_concurrency,true},{read_concurrency,true},{decentralized_counters,true}] ; 1049047.666667; 2197356.866667; 4340404.200000; 9195471.066667; 16056427.533333; 807320.200000; 1048568.600000$
,(master)[set,public,{read_concurrency,true},{decentralized_counters,true}] ; 1384550.933333; 1680694.000000; 840930.533333; 755541.800000; 114837.266667; 18445.600000; 20853.266667$
,(master)[set,public,{decentralized_counters,true}] ; 1462809.266667; 1736019.866667; 832297.933333; 727033.666667; 129652.466667; 18995.466667; 19826.200000$
Scenario:  10.000000% insert,  10.000000% delete,  80.000000% lookup | Key Range Size: 1000000$
; 1; 2; 4; 8; 16; 32; 64$
,(master)[set,public,{write_concurrency,true},{decentralized_counters,true}] ; 1444514.933333; 2967361.866667; 5158188.533333; 10259566.400000; 20018052.466667; 29407494.733333; 6466546.866667$
,(master)[set,public,{write_concurrency,true},{read_concurrency,true},{decentralized_counters,true}] ; 1383653.000000; 2332175.333333; 4594645.133333; 8602095.600000; 16267262.600000; 17260279.800000; 6608737.266667$
,(master)[set,public,{read_concurrency,true},{decentralized_counters,true}] ; 1250219.133333; 2184507.933333; 1126849.866667; 852737.666667; 638197.800000; 296129.733333; 110962.333333$
,(master)[set,public,{decentralized_counters,true}] ; 1759240.266667; 2661106.400000; 2602834.066667; 1165947.466667; 755860.800000; 343991.866667; 113672.733333$
Scenario:  1.000000% insert,  1.000000% delete,  98.000000% lookup | Key Range Size: 1000000$
; 1; 2; 4; 8; 16; 32; 64$
,(master)[set,public,{write_concurrency,true},{decentralized_counters,true}] ; 1397573.866667; 2602723.733333; 5499346.066667; 10622555.066667; 21866040.933333; 36763678.200000; 39517787.533333$
,(master)[set,public,{write_concurrency,true},{read_concurrency,true},{decentralized_counters,true}] ; 1423832.533333; 2492077.600000; 4774517.400000; 9819399.666667; 19865382.133333; 31912354.066667; 23265130.933333$
,(master)[set,public,{read_concurrency,true},{decentralized_counters,true}] ; 1461825.866667; 2650565.866667; 3519237.266667; 2919135.066667; 2227007.333333; 861225.733333; 193433.666667$
,(master)[set,public,{decentralized_counters,true}] ; 1632913.466667; 3186822.333333; 4460040.200000; 4499291.866667; 3060548.266667; 1163736.000000; 183270.200000$
Scenario:  100.000000% lookup | Key Range Size: 1000000$
; 1; 2; 4; 8; 16; 32; 64$
,(master)[set,public,{write_concurrency,true},{decentralized_counters,true}] ; 1855978.800000; 3891426.466667; 6389442.200000; 12827741.000000; 25231761.066667; 42050153.066667; 50093824.400000$
,(master)[set,public,{write_concurrency,true},{read_concurrency,true},{decentralized_counters,true}] ; 1846126.800000; 3299951.800000; 5773774.466667; 11501606.400000; 24988655.200000; 44609713.866667; 54869216.333333$
,(master)[set,public,{read_concurrency,true},{decentralized_counters,true}] ; 2079391.466667; 3295315.933333; 6426861.533333; 12782494.333333; 26066805.800000; 49526711.333333; 58366708.600000$
,(master)[set,public,{decentralized_counters,true}] ; 2393648.133333; 3664511.600000; 6100430.800000; 5912068.800000; 8540737.733333; 6666090.666667; 5006628.733333$

#BENCHMARK ENDED$
      
      
</textarea> 
    <br>
    <input type="checkbox" id="throughputPlot" checked> Include Throughput Plot
    <br>
    <input type="checkbox" id="betterThanWorstPlot"> Include % More Throughput Than Worst Plot
    <br>
    <input type="checkbox" id="worseThanBestPlot"> Include % Less Throughput Than Best Plot
    <br>
    <input type="checkbox" id="barPlot"> Bar Plot
    <br>
    <input type="checkbox" id="sameSpacing" checked> Same X Spacing Between Points
    <br>
    <input type="checkbox" class="showCheck" value="[ordered_set,public]" checked> Show <code>[ordered_set,public]</code>
    <br>
    <input type="checkbox" class="showCheck" value="[ordered_set,public,{write_concurrency,true}]" checked> Show <code>[ordered_set,public,{write_concurrency,true}]</code>
    <br>
    <input type="checkbox" class="showCheck" value="[ordered_set,public,{read_concurrency,true}]" checked> Show <code>[ordered_set,public,{read_concurrency,true}]</code>
    <br>
    <input type="checkbox" class="showCheck" value="[ordered_set,public,{write_concurrency,true},{read_concurrency,true}]" checked> Show <code>[ordered_set,public,{write_concurrency,true},{read_concurrency,true}]</code>
    <br>
    <input type="checkbox" class="showCheck" value="[set,public]" checked> Show <code>[set,public]</code>
    <br>
    <input type="checkbox" class="showCheck" value="[set,public,{write_concurrency,true}]" checked> Show <code>[set,public,{write_concurrency,true}]</code>
    <br>
    <input type="checkbox" class="showCheck" value="[set,public,{read_concurrency,true}]" checked> Show <code>[set,public,{read_concurrency,true}]</code>
    <br>
    <input type="checkbox" class="showCheck" value="[set,public,{write_concurrency,true},{read_concurrency,true}]" checked> Show <code>[set,public,{write_concurrency,true},{read_concurrency,true}]</code>
    <br>
    <button id="renderButton" type="button">Render</button> 
    
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
	    integrity="sha256-3edrmyuQ0w65f8gfBsqowzjJe2iM6n0nKciPUp8y+7E="
	    crossorigin="anonymous"></script>
    <script>
      var loading = false;
      function toggleLoadingScreen(){
          if(loading){
              $("#loading").remove();
              loading = false;
          }else{
              $('<div id="loading">'+
                '<span style="position: fixed; top: 50%;left: 50%;color: white;"><b>Loading...</b></span>'+
                '</div>')
                  .css({position: "fixed",
                        top: 0,
                        left: 0,
                        width: "100%",
                        height: "100%",
                        'background-color': "#000",
                        filter:"alpha(opacity=50)",
                        '-moz-opacity':"0.5",
                        '-khtml-opacity': "0.5",
                        opacity: "0.5",
                        'z-index': "10000"})
                  .appendTo(document.body);
              loading = true;

          }
      }
      //Start loading screen before downloading plotly which is quite large
      toggleLoadingScreen();
    </script>
    <script src="https://cdn.plot.ly/plotly-1.5.0.min.js"></script>    
    <script>
      String.prototype.replaceAll = function(search, replacement) {
          var target = this;
          return target.split(search).join(replacement);
      };
      String.prototype.myTrim = function() {
          var target = this;
          return target.replace(/^\s+|\s+$/g, '');
      };
      function plotGraph(lines, sameSpacing, barPlot, prefix) {
          var xvals = null;
          var data = [];
          while(lines.length > 0 &&
                (lines[0].myTrim() == "" ||
                 lines[0].myTrim().indexOf(";") !== -1)){
              var line = lines.shift().myTrim();
              if(line == "" || line.startsWith("#")){
                  continue;
              } else if(line.startsWith(";")) {
                  xvals = line.split(";")
                  xvals.shift(); // Remove first
                  xvals = $.map(xvals, function (i){
                      if(sameSpacing){
                          return "_"+i.myTrim();
                      }else{
                          return parseInt(i.myTrim(), 10);
                      }
                  });
              }else{
                  line = line.split(";")
                  var label = prefix + line.shift().myTrim();
                  var yvals = $.map(line, function (i){
                      return parseFloat(i.myTrim(), 10);
                  });
                  var trace = {
                      x: xvals,
                      y: yvals,
                      mode: 'lines+markers',
                      name: label
                  };
                  if(barPlot){
                      trace['type'] = "bar";
                  }
                  data.push(trace);
              }
              
          }
          return data;
      }
      function toCompareData(dataParam, compareWithWorst) {
          var data = $.extend(true, [], dataParam);
          var worstSoFarMap = {};
          var defaultSoFarValue = compareWithWorst ? Number.MAX_VALUE : Number.MIN_VALUE;
          function getWorstBestSoFar(x){
              return worstSoFarMap[x] === undefined ? defaultSoFarValue : worstSoFarMap[x];
          }
          function setWorstBestSoFar(x, y){
              return worstSoFarMap[x] = y;
          }
          function lessOrGreaterThan(n1, n2){
            return compareWithWorst ? n1 < n2 : n1 > n2;
          } 
          $.each(data, function(i, allResConfig) {
            $.each(allResConfig.y, function(index, res) {
                var xName = allResConfig.x[index];
                if(lessOrGreaterThan(res, getWorstBestSoFar(xName))){
                    setWorstBestSoFar(xName, res);                     
                }
            });
          });
          $.each(data, function(i, allResConfig) {
            $.each(allResConfig.y, function(index, res) {
                var xName = allResConfig.x[index];
                if(compareWithWorst){
                    allResConfig.y[index] = ((res / getWorstBestSoFar(xName))-1.0) * 100;
                }else{
                    allResConfig.y[index] = (1.0 -(res / getWorstBestSoFar(xName))) * 100;
                }
            });
          });
          return data;
      }
      function toBetterThanWorstData(data){
        return toCompareData(data, true);
      }
      function toWorseThanBestData(data){
        return toCompareData(data, false);
      }
      function plotGraphs(){
          var insertPlaceholder = $("#insertPlaceholder");
          var sameSpacing = $('#sameSpacing').is(":checked");
          var barPlot = $('#barPlot').is(":checked");
          var throughputPlot = $('#throughputPlot').is(":checked");
          var betterThanWorstPlot = $('#betterThanWorstPlot').is(":checked");
          var worseThanBestPlot = $('#worseThanBestPlot').is(":checked");
          var lines = $("#dataField").val();
          $('.showCheck').each(function() {
              var item = $(this);
              if(!item.is(":checked")){
                  lines = lines.replaceAll(item.val(), "#"+item.val())
              }
          });
          lines = lines.split("$");
          var nrOfGraphs = 0;
          var scenarioDataMap = {};
          var scenarioNrOfVersionsMap = {};
          var scenarioList = [];
          while(lines.length > 0){
              var line = lines.shift().myTrim();
              if(line == ""){
                  continue;
              } else if(line.startsWith("Scenario:")) {
                  nrOfGraphs = nrOfGraphs + 1;
                  var name = line;
                  if(scenarioDataMap[name] === undefined){
                      scenarioDataMap[name] = [];
                      scenarioNrOfVersionsMap[name] = 0;
                      scenarioList.push(line);
                  }
                  scenarioNrOfVersionsMap[name] = scenarioNrOfVersionsMap[name] + 1;
                  var prefix = undefined;
                  if(scenarioNrOfVersionsMap[name] === 1){
                      prefix = "";
                  }else{
                      prefix = "Ver: " + scenarioNrOfVersionsMap[name] + " ";
                  }
                  scenarioDataMap[name] =
                      scenarioDataMap[name].concat(
                          plotGraph(lines, sameSpacing, barPlot, prefix));
              }
          }
          var nrOfGraphs = 0;
          function plotScenario(name, plotType) {
              var data = scenarioDataMap[name];
              var yAxisTitle = undefined;
              var graphId = "graph" + nrOfGraphs;
              var fullscreenButtonid = "fullscreenButton" + nrOfGraphs;
              nrOfGraphs = nrOfGraphs + 1;
              $("<div class='added' id='" + graphId + "'>")
                  .insertBefore(insertPlaceholder);
              $("<button type='button' class='added' id='" + fullscreenButtonid + "'>Fill screen</button>")
                  .insertBefore(insertPlaceholder);
              $("<span class='added'><br><hr><br></span>")
                  .insertBefore(insertPlaceholder);
              if (plotType === 'throughput') {
                  yAxisTitle = 'Operations/Second';
              } else if (plotType === 'better_than_worst') {
                  yAxisTitle = '% More Throughput Than Worst';
                  data = toBetterThanWorstData(data);
              } else {
                  yAxisTitle = '% Less Throughput Than Best';
                  data = toWorseThanBestData(data);
              }
              var layout = {
                  title: name,
                  xaxis: {
                      title: '# of Processes'
                  },
                  yaxis: {
                      title: yAxisTitle
                  }
              };
              $("#" + fullscreenButtonid).click(
                  function () {
                      $('#' + graphId).replaceWith(
                          $("<div class='added' id='" + graphId + "'>"));
                      layout = $.extend({}, layout, {
                          width: $(window).width() - 40,
                          height: $(window).height() - 40
                      });
                      Plotly.newPlot(graphId, data, layout);
                  });
              Plotly.newPlot(graphId, data, layout);
          }
          $.each(scenarioList,
              function (index, name) {
                  if (throughputPlot) {
                      plotScenario(name, 'throughput');
                  }
                  if (betterThanWorstPlot) {
                      plotScenario(name, 'better_than_worst');
                  }
                  if (worseThanBestPlot) {
                      plotScenario(name, 'worse_than_best');
                  }
              });
      }
    $(document).ready(function(){
        $('#renderButton').click(
            function(){
                toggleLoadingScreen();
                setTimeout(function(){
                    try {                       
                        $( ".added" ).remove();
                        plotGraphs();
                        toggleLoadingScreen();
                    } catch(e){
                        toggleLoadingScreen();
                        console.log(e);
                        alert("Error happened when parsing data.\n" +
                              "See console for more info");
                    }
                }, 10);
            });
        setTimeout(function(){
            $( ".added" ).remove();
            plotGraphs();
            toggleLoadingScreen();
        }, 10);
    });
  </script>
  </body>
</html>
